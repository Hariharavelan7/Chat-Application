{"ast":null,"code":"import { Observable } from 'rxjs';\nimport { io } from 'socket.io-client';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class ChatService {\n  constructor(http) {\n    this.http = http;\n    this.apiUrl = 'http://localhost:3000';\n    this.socket = io('http://localhost:3000');\n  }\n  getAllUsers() {\n    return this.http.get(`${this.apiUrl}/users`);\n  }\n  getMessages(userId1, userId2) {\n    return this.http.get(`${this.apiUrl}/messages/${userId1}/${userId2}`);\n  }\n  // Socket.IO methods\n  joinChat(userId) {\n    this.socket.emit('join', {\n      userId\n    });\n  }\n  sendMessage(content, senderId, receiverId) {\n    this.socket.emit('sendMessage', {\n      content,\n      senderId,\n      receiverId\n    });\n  }\n  onNewMessage() {\n    return new Observable(observer => {\n      this.socket.on('newMessage', message => {\n        observer.next(message);\n      });\n    });\n  }\n  onMessageSent() {\n    return new Observable(observer => {\n      this.socket.on('messageSent', message => {\n        observer.next(message);\n      });\n    });\n  }\n  onMessages() {\n    return new Observable(observer => {\n      this.socket.on('messages', messages => {\n        observer.next(messages);\n      });\n    });\n  }\n  onError() {\n    return new Observable(observer => {\n      this.socket.on('error', error => {\n        observer.next(error);\n      });\n    });\n  }\n  getMessagesFromSocket(userId1, userId2) {\n    this.socket.emit('getMessages', {\n      userId1,\n      userId2\n    });\n  }\n  disconnect() {\n    this.socket.disconnect();\n  }\n  static {\n    this.ɵfac = function ChatService_Factory(t) {\n      return new (t || ChatService)(i0.ɵɵinject(i1.HttpClient));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: ChatService,\n      factory: ChatService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["Observable","io","ChatService","constructor","http","apiUrl","socket","getAllUsers","get","getMessages","userId1","userId2","joinChat","userId","emit","sendMessage","content","senderId","receiverId","onNewMessage","observer","on","message","next","onMessageSent","onMessages","messages","onError","error","getMessagesFromSocket","disconnect","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["/var/www/html/chat-applictaion/frontend/src/app/services/chat.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { io, Socket } from 'socket.io-client';\n\nexport interface Message {\n  id: number;\n  content: string;\n  senderId: number;\n  receiverId: number;\n  createdAt: string;\n}\n\nexport interface User {\n  id: number;\n  email: string;\n  name: string;\n  createdAt: string;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ChatService {\n  private apiUrl = 'http://localhost:3000';\n  private socket: Socket;\n\n  constructor(private http: HttpClient) {\n    this.socket = io('http://localhost:3000');\n  }\n\n  getAllUsers(): Observable<User[]> {\n    return this.http.get<User[]>(`${this.apiUrl}/users`);\n  }\n\n  getMessages(userId1: number, userId2: number): Observable<Message[]> {\n    return this.http.get<Message[]>(`${this.apiUrl}/messages/${userId1}/${userId2}`);\n  }\n\n  // Socket.IO methods\n  joinChat(userId: number): void {\n    this.socket.emit('join', { userId });\n  }\n\n  sendMessage(content: string, senderId: number, receiverId: number): void {\n    this.socket.emit('sendMessage', { content, senderId, receiverId });\n  }\n\n  onNewMessage(): Observable<Message> {\n    return new Observable(observer => {\n      this.socket.on('newMessage', (message: Message) => {\n        observer.next(message);\n      });\n    });\n  }\n\n  onMessageSent(): Observable<Message> {\n    return new Observable(observer => {\n      this.socket.on('messageSent', (message: Message) => {\n        observer.next(message);\n      });\n    });\n  }\n\n  onMessages(): Observable<Message[]> {\n    return new Observable(observer => {\n      this.socket.on('messages', (messages: Message[]) => {\n        observer.next(messages);\n      });\n    });\n  }\n\n  onError(): Observable<{ message: string }> {\n    return new Observable(observer => {\n      this.socket.on('error', (error: { message: string }) => {\n        observer.next(error);\n      });\n    });\n  }\n\n  getMessagesFromSocket(userId1: number, userId2: number): void {\n    this.socket.emit('getMessages', { userId1, userId2 });\n  }\n\n  disconnect(): void {\n    this.socket.disconnect();\n  }\n}\n\n"],"mappings":"AAEA,SAASA,UAAU,QAAQ,MAAM;AACjC,SAASC,EAAE,QAAgB,kBAAkB;;;AAoB7C,OAAM,MAAOC,WAAW;EAItBC,YAAoBC,IAAgB;IAAhB,KAAAA,IAAI,GAAJA,IAAI;IAHhB,KAAAC,MAAM,GAAG,uBAAuB;IAItC,IAAI,CAACC,MAAM,GAAGL,EAAE,CAAC,uBAAuB,CAAC;EAC3C;EAEAM,WAAWA,CAAA;IACT,OAAO,IAAI,CAACH,IAAI,CAACI,GAAG,CAAS,GAAG,IAAI,CAACH,MAAM,QAAQ,CAAC;EACtD;EAEAI,WAAWA,CAACC,OAAe,EAAEC,OAAe;IAC1C,OAAO,IAAI,CAACP,IAAI,CAACI,GAAG,CAAY,GAAG,IAAI,CAACH,MAAM,aAAaK,OAAO,IAAIC,OAAO,EAAE,CAAC;EAClF;EAEA;EACAC,QAAQA,CAACC,MAAc;IACrB,IAAI,CAACP,MAAM,CAACQ,IAAI,CAAC,MAAM,EAAE;MAAED;IAAM,CAAE,CAAC;EACtC;EAEAE,WAAWA,CAACC,OAAe,EAAEC,QAAgB,EAAEC,UAAkB;IAC/D,IAAI,CAACZ,MAAM,CAACQ,IAAI,CAAC,aAAa,EAAE;MAAEE,OAAO;MAAEC,QAAQ;MAAEC;IAAU,CAAE,CAAC;EACpE;EAEAC,YAAYA,CAAA;IACV,OAAO,IAAInB,UAAU,CAACoB,QAAQ,IAAG;MAC/B,IAAI,CAACd,MAAM,CAACe,EAAE,CAAC,YAAY,EAAGC,OAAgB,IAAI;QAChDF,QAAQ,CAACG,IAAI,CAACD,OAAO,CAAC;MACxB,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;EAEAE,aAAaA,CAAA;IACX,OAAO,IAAIxB,UAAU,CAACoB,QAAQ,IAAG;MAC/B,IAAI,CAACd,MAAM,CAACe,EAAE,CAAC,aAAa,EAAGC,OAAgB,IAAI;QACjDF,QAAQ,CAACG,IAAI,CAACD,OAAO,CAAC;MACxB,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;EAEAG,UAAUA,CAAA;IACR,OAAO,IAAIzB,UAAU,CAACoB,QAAQ,IAAG;MAC/B,IAAI,CAACd,MAAM,CAACe,EAAE,CAAC,UAAU,EAAGK,QAAmB,IAAI;QACjDN,QAAQ,CAACG,IAAI,CAACG,QAAQ,CAAC;MACzB,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;EAEAC,OAAOA,CAAA;IACL,OAAO,IAAI3B,UAAU,CAACoB,QAAQ,IAAG;MAC/B,IAAI,CAACd,MAAM,CAACe,EAAE,CAAC,OAAO,EAAGO,KAA0B,IAAI;QACrDR,QAAQ,CAACG,IAAI,CAACK,KAAK,CAAC;MACtB,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;EAEAC,qBAAqBA,CAACnB,OAAe,EAAEC,OAAe;IACpD,IAAI,CAACL,MAAM,CAACQ,IAAI,CAAC,aAAa,EAAE;MAAEJ,OAAO;MAAEC;IAAO,CAAE,CAAC;EACvD;EAEAmB,UAAUA,CAAA;IACR,IAAI,CAACxB,MAAM,CAACwB,UAAU,EAAE;EAC1B;;;uBA/DW5B,WAAW,EAAA6B,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA;IAAA;EAAA;;;aAAXhC,WAAW;MAAAiC,OAAA,EAAXjC,WAAW,CAAAkC,IAAA;MAAAC,UAAA,EAFV;IAAM;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}